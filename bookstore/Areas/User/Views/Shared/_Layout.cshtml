@using Microsoft.AspNetCore.Identity
@inject SignInManager<bookstore.Areas.Admin.Models.UserModel> SignInManager
@inject UserManager<bookstore.Areas.Admin.Models.UserModel> UserManager
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>@ViewData["Title"] - Fahaha</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="~/images/logo/favicon.ico">
    <link type="text/css" rel="stylesheet" href="~/User/public/css/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="~/User/public/css/slick.css" />
    <link type="text/css" rel="stylesheet" href="~/User/public/css/slick-theme.css" />
    <link type="text/css" rel="stylesheet" href="~/User/public/css/nouislider.min.css" />
    <link type="text/css" rel="stylesheet" href="~/User/public/css/font-awesome.min.css">
    <link type="text/css" rel="stylesheet" href="~/User/public/css/stylenew1.css" />
    <link type="text/css" rel="stylesheet" href="~/User/public/css/custom1.css" />


</head>
<body>

    <header>

        <div id="top-header">
            <div class="container">
                <ul class="header-links pull-left">
                    <li><a href="#"><i class="fa fa-phone"></i> +021-95-51-84</a></li>
                </ul>
                <ul class="header-links pull-right">
                </ul>
            </div>
        </div>

        <div id="header">
            <!-- container -->
            <div class="container">

                <div class="row">

                    <div class="col-md-3">
                        <div class="header-logo">
                            <a class="logo" asp-action="index" asp-controller="home" asp-area="user">
                                <img src="~/images/logo/logo.png" alt="" width="100px">
                            </a>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="header-search">
                            <form method="post" asp-action="searchProduct" asp-controller="product" >
                                <input class="input" name="title" placeholder="Bạn muốn tìm gì">
                                <button type="submit" class="search-btn">
                                    Tìm kiếm
                                </button>
                            </form>
                        </div>
                    </div>

                    <div class="col-md-3 clearfix">
                        <div class="header-ctn">

                            @if (SignInManager.IsSignedIn(User))
                            {
                                <div class="dropdown">
                                    <a class="dropdown-toggle" data-toggle="dropdown" aria-expanded="true">
                                        <img src="~/images/logo/logo.png" width="40" height="40" style="position: absolute; bottom: 0px; border-radius: 50%;" />
                                    </a>
                                    <div class="cart-dropdown" style="width:150px;text-align:center">
                                        <div style="cursor:pointer" onclick="location.href='@Url.Action("Index","Customer",new {customer_id = UserManager.GetUserId(User)})'">
                                            <a>Thông tin</a>
                                            <i class='bx bx-cog'></i>
                                        </div>
                                        <div onclick="location.href='@Url.Action("logout","Home")'" style="cursor:pointer">
                                            <a>Đăng xuất</a>
                                            <i  class='bx bx-power-off'></i>

                                        </div>

                                    </div>
                                </div>
                                
                            }
                            else
                            {
                                <div>
                                    <a asp-area="Identity" asp-page="/Account/Login">
                                        <i class="bx bxs-user"></i>
                                        <span>Đăng nhập</span>
                                    </a>
                                </div>
                            }
                         
                            


                            @await Html.PartialAsync("_PartialCart.cshtml")
                            

                        </div>
                    </div>

                </div>

            </div>

        </div>

    </header>


    @RenderBody()


    <div id="newsletter" class="section">
        <!-- container -->
        <div class="container">
            <!-- row -->
            <div class="row">
                <div class="col-md-12">
                    <div class="newsletter">
                        <p>Đăng ký nhận tin <strong>KHUYẾN MÃI</strong></p>
                        <form>
                            <input class="input" type="email" placeholder="Nhập Email">
                            <button class="newsletter-btn"><i class="fa fa-envelope"></i> Đăng ký</button>
                        </form>
                        <ul class="newsletter-follow">
                            <li>
                                <a href="#"><i class="fa fa-facebook"></i></a>
                            </li>
                            <li>
                                <a href="#"><i class="fa fa-twitter"></i></a>
                            </li>
                            <li>
                                <a href="#"><i class="fa fa-instagram"></i></a>
                            </li>
                            <li>
                                <a href="#"><i class="fa fa-pinterest"></i></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- /row -->
        </div>
        <!-- /container -->
    </div>



    <footer id="footer">
        <div class="section">
            <div class="container">
                <div class="row">
                    <div class="col-md-3 col-xs-6">
                        <div class="footer">
                            <h3 class="footer-title">About Us</h3>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut.</p>
                            <ul class="footer-links">
                                <li><a href="#"><i class="fa fa-map-marker"></i>1734 Stonecoal Road</a></li>
                                <li><a href="#"><i class="fa fa-phone"></i>+021-95-51-84</a></li>
                                <li><a href="#"><i class="fa fa-envelope-o"></i>email@email.com</a></li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-md-3 col-xs-6">
                        <div class="footer">
                            <h3 class="footer-title">Categories</h3>
                            <ul class="footer-links">
                                <li><a href="#">Hot deals</a></li>
                                <li><a href="#">Laptops</a></li>
                                <li><a href="#">Smartphones</a></li>
                                <li><a href="#">Cameras</a></li>
                                <li><a href="#">Accessories</a></li>
                            </ul>
                        </div>
                    </div>

                    <div class="clearfix visible-xs"></div>

                    <div class="col-md-3 col-xs-6">
                        <div class="footer">
                            <h3 class="footer-title">Information</h3>
                            <ul class="footer-links">
                                <li><a href="#">About Us</a></li>
                                <li><a href="#">Contact Us</a></li>
                                <li><a href="#">Privacy Policy</a></li>
                                <li><a href="#">Orders and Returns</a></li>
                                <li><a href="#">Terms & Conditions</a></li>
                            </ul>
                        </div>
                    </div>

                    <div class="col-md-3 col-xs-6">
                        <div class="footer">
                            <h3 class="footer-title">Service</h3>
                            <ul class="footer-links">
                                <li><a href="#">My Account</a></li>
                                <li><a href="#">View Cart</a></li>
                                <li><a href="#">Wishlist</a></li>
                                <li><a href="#">Track My Order</a></li>
                                <li><a href="#">Help</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div id="bottom-footer" class="section">
            <div class="container">
                <div class="row">
                    <div class="col-md-12 text-center">
                        <ul class="footer-payments">
                            <li><a href="#"><i class="fa fa-cc-visa"></i></a></li>
                            <li><a href="#"><i class="fa fa-credit-card"></i></a></li>
                            <li><a href="#"><i class="fa fa-cc-paypal"></i></a></li>
                            <li><a href="#"><i class="fa fa-cc-mastercard"></i></a></li>
                            <li><a href="#"><i class="fa fa-cc-discover"></i></a></li>
                            <li><a href="#"><i class="fa fa-cc-amex"></i></a></li>
                        </ul>
                        <span class="copyright">
                            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="~/User/public/js/jquery.min.js"></script>
  <script src="~/User/public/js/bootstrap.min.js"></script>
  <script src="~/User/public/js/slick.min.js"></script>
  <script src="~/User/public/js/nouislider.min.js"></script>
  <script src="~/User/public/js/jquery.zoom.min.js"></script>
  <script src="~/User/public/js/main.js"></script>
  
    @await RenderSectionAsync("Scripts", required: false)
    @await Component.InvokeAsync("NToastNotify")


        <script>
            $(document).ready(function () {

                /* 1. Visualizing things on Hover - See next part for action on click */
                $('#stars li').on('mouseover', function () {
                    var onStar = parseInt($(this).data('value'), 10); // The star currently mouse on

                    // Now highlight all the stars that's not after the current hovered star
                    $(this).parent().children('li.star').each(function (e) {
                        if (e < onStar) {
                            $(this).addClass('hover');
                        }
                        else {
                            $(this).removeClass('hover');
                        }
                    });

                }).on('mouseout', function () {
                    $(this).parent().children('li.star').each(function (e) {
                        $(this).removeClass('hover');
                    });
                });


                /* 2. Action to perform on click */
                $('#stars li').on('click', function () {
                    var onStar = parseInt($(this).data('value'), 10); // The star currently selected
                    var stars = $(this).parent().children('li.star');

                    for (i = 0; i < stars.length; i++) {
                        $(stars[i]).removeClass('selected');
                    }

                    for (i = 0; i < onStar; i++) {
                        $(stars[i]).addClass('selected');
                    }

                    // JUST RESPONSE (Not needed)
                    var ratingValue = parseInt($('#stars li.selected').last().data('value'), 10);
                    var msg = "";
                    if (ratingValue > 1) {
                        msg = "Thanks! You rated this " + ratingValue + " stars.";
                    }
                    else {
                        msg = "We will improve ourselves. You rated this " + ratingValue + " stars.";
                    }
                    responseMessage(msg);

                });
            $('#submit-btn').click(function () {
                var lastSelected = $('#stars li.selected').last();
                var dataValue = lastSelected.data('value');
                var bookid = $('#bookid').val();
                var customerid = $('input[name="customerid"]').val();
                var description = $('textarea[name="desciption"]').val()
                console.log(description)
                console.log(dataValue)
                console.log(bookid)
                console.log(customerid)
                $.ajax({
                    type: 'POST',
                    url: '/customer/review',
                    data: { ratingValue: dataValue,
                        bookid: bookid,
                        customerid : customerid,
                        description : description
                    },
                    success : function(data){
                        window.location.href = "@Url.RouteUrl("cart")";
                    }

               
                   
                  
                });
            });

                $('.detailModel').on("click", function () {
                    var id = $(this).attr("value");
                
                    $.ajax({
                        url: '/ajax/' + id,
                        type: 'get',
                        dataType: 'JSON',
                        success: function (data) {
                       

                            $('#bookcover').attr("src", data.cover)
                        $('#bookid').val(data.id)
                            $('#booktitle').text(data.title)



                        },
                        Error: function () {
                            console.log("that bai")
                        }
                    })


                })


            });

      


        function responseMessage(msg) {
            $('.success-box').fadeIn(200);
            $('.success-box div.text-message').html("<span>" + msg + "</span>");
        }
    </script>
   


</body>

</html>